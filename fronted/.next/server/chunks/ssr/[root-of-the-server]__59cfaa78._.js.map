{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LVazquez/OneDrive%20-%20CERVECERIA%20CIELITO%20LINDO/Escritorio/CandiGo/CandiGo/fronted/src/lib/supabaseClient.ts"],"sourcesContent":["'use client';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useEffect } from 'react';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    persistSession: true,\r\n    autoRefreshToken: true,\r\n    detectSessionInUrl: true,\r\n  },\r\n});\r\n\r\nexport function useAuth(onAuth: (session: any) => void) {\r\n  useEffect(() => {\r\n    const { data: subscription } = supabase.auth.onAuthStateChange(\r\n      async (event, session) => {\r\n        if (event === 'SIGNED_IN') {\r\n          onAuth(session);\r\n        } else if (event === 'SIGNED_OUT') {\r\n          onAuth(null);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => subscription?.subscription?.unsubscribe();\r\n  }, [onAuth]);\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAIA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,CAAA,GAAA,uLAAA,CAAA,eAAY,AAAD,EAAE,aAAa,iBAAiB;IACjE,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF;AAEO,SAAS,QAAQ,MAA8B;IACpD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB,CAC5D,OAAO,OAAO;YACZ,IAAI,UAAU,aAAa;gBACzB,OAAO;YACT,OAAO,IAAI,UAAU,cAAc;gBACjC,OAAO;YACT;QACF;QAGF,OAAO,IAAM,cAAc,cAAc;IAC3C,GAAG;QAAC;KAAO;AACb","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/LVazquez/OneDrive%20-%20CERVECERIA%20CIELITO%20LINDO/Escritorio/CandiGo/CandiGo/fronted/src/app/r9t2u5v1/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport Calendar from 'react-calendar';\r\nimport 'react-calendar/dist/Calendar.css';\r\nimport './calendario.css';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface Evento {\r\n  id: number;\r\n  number?: number;\r\n  titulo: string;\r\n  categoria?: string;\r\n  descripcion: string;\r\n  fecha: string; // ISO\r\n  created_at?: string;\r\n  user_id: string;\r\n}\r\n\r\nfunction getISODate(date: Date) {\r\n  return date.toISOString().slice(0, 10);\r\n}\r\n\r\nexport default function CalendarioPage() {\r\n  const [userId, setUserId] = useState<string | null>(null);\r\n  const [value, setValue] = useState<Date | null>(new Date());\r\n  const [eventos, setEventos] = useState<Evento[]>([]);\r\n  const [nuevoTitulo, setNuevoTitulo] = useState('');\r\n  const [nuevoDescripcion, setNuevoDescripcion] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [loadingUser, setLoadingUser] = useState(true);\r\n  const router = useRouter();\r\n\r\n  // Obtener usuario actual\r\n  useEffect(() => {\r\n    const fetchUser = async () => {\r\n      try {\r\n        const { data, error } = await supabase.auth.getUser();\r\n        if (error) {\r\n          console.error('Error al obtener usuario:', error.message);\r\n          setUserId(null);\r\n        } else if (data.user) {\r\n          setUserId(data.user.id);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error inesperado:', err);\r\n      } finally {\r\n        setLoadingUser(false);\r\n      }\r\n    };\r\n\r\n    fetchUser();\r\n\r\n    // Escuchar cambios de sesión\r\n    const { data: listener } = supabase.auth.onAuthStateChange((_event, session) => {\r\n      setUserId(session?.user?.id ?? null);\r\n    });\r\n\r\n    return () => listener.subscription.unsubscribe();\r\n  }, []);\r\n\r\n  // Obtener eventos desde Supabase\r\n  const fetchEventos = async () => {\r\n    const { data, error } = await supabase\r\n      .from('eventos')\r\n      .select('*')\r\n      .order('fecha', { ascending: true });\r\n    if (error) {\r\n      console.error('Error al obtener eventos:', error);\r\n      return;\r\n    }\r\n    if (data) setEventos(data as Evento[]);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchEventos();\r\n  }, []);\r\n\r\n  const eventosDelDia = value\r\n    ? eventos.filter((ev) => ev.fecha === getISODate(value))\r\n    : [];\r\n\r\n  // Agregar evento\r\n  const agregarEvento = async () => {\r\n    if (!value || !nuevoTitulo || !userId) {\r\n      alert('Completa todos los campos y asegúrate de estar logueado');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    const fechaISO = getISODate(value);\r\n\r\n    const { data, error } = await supabase\r\n      .from('eventos')\r\n      .insert([\r\n        {\r\n          titulo: nuevoTitulo,\r\n          descripcion: nuevoDescripcion,\r\n          fecha: fechaISO,\r\n          categoria: 'personal',\r\n          user_id: userId,\r\n        },\r\n      ])\r\n      .select() as any;\r\n\r\n    setLoading(false);\r\n\r\n    if (error) {\r\n      console.error('Error al insertar evento:', error);\r\n      alert('No se pudo agregar el evento');\r\n      return;\r\n    }\r\n\r\n    if (data) {\r\n      setEventos([...eventos, ...data]);\r\n      setNuevoTitulo('');\r\n      setNuevoDescripcion('');\r\n    }\r\n  };\r\n\r\n  if (loadingUser) return <div>Cargando usuario...</div>;\r\n  if (!userId) return <div>No hay usuario logueado</div>;\r\n\r\n  return (\r\n    <div className=\"calendar-page\">\r\n      <header className=\"header\">\r\n        <h1>Calendario</h1>\r\n        <button className=\"back-button\" onClick={() => router.push('/d3h7m1p4')}>\r\n          Regresar\r\n        </button>\r\n        <div style={{ width: '1.5rem' }} />\r\n      </header>\r\n\r\n      <main className=\"main\">\r\n        <Calendar\r\n          onChange={(val) => setValue(val as Date)}\r\n          value={value}\r\n          tileContent={({ date, view }) => {\r\n            if (view === 'month' && eventos.some((ev) => ev.fecha === getISODate(date))) {\r\n              return <span style={{ color: '#2563eb', fontSize: '1.2em' }}>•</span>;\r\n            }\r\n            return null;\r\n          }}\r\n        />\r\n\r\n        <p className=\"selected-date\">\r\n  Fecha seleccionada:{' '}\r\n  <span>\r\n    {value\r\n      ? value.toLocaleDateString('es-MX', {\r\n          weekday: 'long',\r\n          year: 'numeric',\r\n          month: 'long',\r\n          day: 'numeric',\r\n        })\r\n      : 'No hay fecha seleccionada'}\r\n  </span>\r\n</p>\r\n\r\n\r\n        {eventosDelDia.length > 0 && (\r\n          <div className=\"eventos-dia\">\r\n            <h3>Eventos del día:</h3>\r\n            <ul>\r\n              {eventosDelDia.map((ev) => (\r\n                <li key={ev.id}>\r\n                  <strong>{ev.titulo}</strong>: {ev.descripcion}{' '}\r\n                  {ev.user_id === userId && '(Tuyo)'}\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"nuevo-evento\">\r\n          <h3>Agregar evento</h3>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Título\"\r\n            value={nuevoTitulo}\r\n            onChange={(e) => setNuevoTitulo(e.target.value)}\r\n          />\r\n          <textarea\r\n            placeholder=\"Descripción\"\r\n            value={nuevoDescripcion}\r\n            onChange={(e) => setNuevoDescripcion(e.target.value)}\r\n          />\r\n          <button onClick={agregarEvento} disabled={loading}>\r\n            {loading ? 'Agregando...' : 'Agregar'}\r\n          </button>\r\n        </div>\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}