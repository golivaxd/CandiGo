{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/lib/supabaseClient.ts"],"sourcesContent":["'use client';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useEffect } from 'react';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    persistSession: true,\r\n    autoRefreshToken: true,\r\n    detectSessionInUrl: true,\r\n  },\r\n});\r\n\r\nexport function useAuth(onAuth: (session: any) => void) {\r\n  useEffect(() => {\r\n    const { data: subscription } = supabase.auth.onAuthStateChange(\r\n      async (event, session) => {\r\n        if (event === 'SIGNED_IN') {\r\n          onAuth(session);\r\n        } else if (event === 'SIGNED_OUT') {\r\n          onAuth(null);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => subscription?.subscription?.unsubscribe();\r\n  }, [onAuth]);\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAIA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,CAAA,GAAA,uLAAA,CAAA,eAAY,AAAD,EAAE,aAAa,iBAAiB;IACjE,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF;AAEO,SAAS,QAAQ,MAA8B;IACpD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB,CAC5D,OAAO,OAAO;YACZ,IAAI,UAAU,aAAa;gBACzB,OAAO;YACT,OAAO,IAAI,UAAU,cAAc;gBACjC,OAAO;YACT;QACF;QAGF,OAAO,IAAM,cAAc,cAAc;IAC3C,GAAG;QAAC;KAAO;AACb","debugId":null}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/foro/foro.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"backButton\": \"foro-module__h9DDxW__backButton\",\n  \"buttonComentario\": \"foro-module__h9DDxW__buttonComentario\",\n  \"comentario\": \"foro-module__h9DDxW__comentario\",\n  \"comentariosList\": \"foro-module__h9DDxW__comentariosList\",\n  \"container\": \"foro-module__h9DDxW__container\",\n  \"debateAuthor\": \"foro-module__h9DDxW__debateAuthor\",\n  \"debateDescription\": \"foro-module__h9DDxW__debateDescription\",\n  \"debateItem\": \"foro-module__h9DDxW__debateItem\",\n  \"debateList\": \"foro-module__h9DDxW__debateList\",\n  \"debateTitle\": \"foro-module__h9DDxW__debateTitle\",\n  \"footer\": \"foro-module__h9DDxW__footer\",\n  \"header\": \"foro-module__h9DDxW__header\",\n  \"newDebateButton\": \"foro-module__h9DDxW__newDebateButton\",\n  \"textareaComentario\": \"foro-module__h9DDxW__textareaComentario\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 148, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/app/foro/page.tsx"],"sourcesContent":["'use client';\nimport { useEffect, useState } from 'react';\nimport { supabase } from '@/lib/supabaseClient';\nimport styles from './foro.module.css';\n\ninterface Debate {\n  id: number;\n  title: string;\n  author: string;\n  created_at: string;\n  description: string;\n}\n\ninterface Comentario {\n  id: number;\n  debate_id: number;\n  autor: string;\n  contenido: string;\n  created_at: string;\n  user_id: string;\n}\n\nexport default function Foro() {\n  const [debates, setDebates] = useState<Debate[]>([]);\n  const [selectedDebate, setSelectedDebate] = useState<Debate | null>(null);\n  const [comentarios, setComentarios] = useState<Comentario[]>([]);\n  const [newComentario, setNewComentario] = useState('');\n  const [newDebateTitle, setNewDebateTitle] = useState('');\n  const [newDebateDescription, setNewDebateDescription] = useState('');\n  const [showNewDebateForm, setShowNewDebateForm] = useState(false);\n  const [user, setUser] = useState<any>(null);\n\n  useEffect(() => {\n    fetchDebates();\n\n    // Obtener usuario autenticado\n    supabase.auth.getSession().then(({ data }) => {\n      if (data.session) setUser(data.session.user);\n    });\n\n    // Escuchar cambios de auth\n    supabase.auth.onAuthStateChange((_event, session) => {\n      setUser(session?.user || null);\n    });\n  }, []);\n\n  const fetchDebates = async () => {\n    const { data } = await supabase\n      .from('debates')\n      .select('*')\n      .order('created_at', { ascending: false });\n    if (data) setDebates(data);\n  };\n\n  const fetchComentarios = async (debateId: number) => {\n    const { data } = await supabase\n      .from('comentarios')\n      .select('*')\n      .eq('debate_id', debateId)\n      .order('created_at', { ascending: true });\n    if (data) setComentarios(data);\n  };\n\n  const handleDebateClick = (debate: Debate) => {\n    setSelectedDebate(debate);\n    fetchComentarios(debate.id);\n  };\n\n  const handleAddComentario = async () => {\n    if (!newComentario.trim() || !selectedDebate || !user) return;\n\n    const displayName = user.user_metadata?.full_name || user.user_metadata?.display_name || 'Usuario';\n\n    const { data } = await supabase\n      .from('comentarios')\n      .insert({\n        debate_id: selectedDebate.id,\n        autor: displayName,\n        contenido: newComentario,\n        created_at: new Date().toISOString(),\n        user_id: user.id\n      })\n      .select()\n      .single();\n\n    if (data) {\n      setComentarios([...comentarios, data]);\n      setNewComentario(''); // Limpiar textarea\n    }\n  };\n\n  const handleAddDebate = async () => {\n    if (!newDebateTitle.trim() || !newDebateDescription.trim() || !user) return;\n\n    const displayName = user.user_metadata?.full_name || user.user_metadata?.display_name || 'Usuario';\n\n    const { data } = await supabase\n      .from('debates')\n      .insert({\n        title: newDebateTitle,\n        description: newDebateDescription,\n        author: displayName,\n        created_at: new Date().toISOString()\n      })\n      .select()\n      .single();\n\n    if (data) {\n      setDebates([data, ...debates]); // Mostrar nuevo debate de inmediato\n      setShowNewDebateForm(false);\n      setNewDebateTitle('');       // Limpiar campo\n      setNewDebateDescription(''); // Limpiar campo\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      {/* HEADER */}\n      <header className={styles.header}>\n        <h1>Foro de Debates</h1>\n        <button onClick={() => window.location.href = '/dashboard'}>← Regresar</button>\n      </header>\n\n      {/* LISTA DE DEBATES */}\n      {!selectedDebate && !showNewDebateForm && (\n        <>\n          <button className={styles.newDebateButton} onClick={() => setShowNewDebateForm(true)}>\n            + Nuevo Debate\n          </button>\n          <ul className={styles.debateList}>\n            {debates.map((debate) => (\n              <li key={debate.id} className={styles.debateItem} onClick={() => handleDebateClick(debate)}>\n                <h3 className={styles.debateTitle}>{debate.title}</h3>\n                <p className={styles.debateDescription}>{debate.description}</p>\n                <small className={styles.debateAuthor}>\n                  Por {debate.author} - {new Date(debate.created_at).toLocaleString()}\n                </small>\n              </li>\n            ))}\n          </ul>\n        </>\n      )}\n\n      {/* FORMULARIO NUEVO DEBATE */}\n      {showNewDebateForm && (\n        <div>\n          <button className={styles.backButton} onClick={() => setShowNewDebateForm(false)}>← Volver</button>\n          <h2>Crear nuevo debate</h2>\n          <input\n            placeholder=\"Título del debate\"\n            value={newDebateTitle}\n            onChange={(e) => setNewDebateTitle(e.target.value)}\n            style={{ width: '100%', marginBottom: '0.5rem', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ccc' }}\n          />\n          <textarea\n            placeholder=\"Descripción\"\n            value={newDebateDescription}\n            onChange={(e) => setNewDebateDescription(e.target.value)}\n            style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ccc', minHeight: '80px', marginBottom: '0.5rem' }}\n          />\n          <button className={styles.newDebateButton} onClick={handleAddDebate}>Crear Debate</button>\n        </div>\n      )}\n\n      {/* DETALLE DE DEBATE */}\n      {selectedDebate && (\n        <div>\n          <button className={styles.backButton} onClick={() => setSelectedDebate(null)}>← Volver a debates</button>\n          <h2 className={styles.debateTitle}>{selectedDebate.title}</h2>\n          <p className={styles.debateDescription}>{selectedDebate.description}</p>\n          <small className={styles.debateAuthor}>\n            Por {selectedDebate.author} - {new Date(selectedDebate.created_at).toLocaleString()}\n          </small>\n\n          <h3>Comentarios</h3>\n          <div className={styles.comentariosList}>\n            {comentarios.map((c) => (\n              <div key={c.id} className={styles.comentario}>\n                <strong>{c.autor}</strong> <small>{new Date(c.created_at).toLocaleString()}</small>\n                <p>{c.contenido}</p>\n              </div>\n            ))}\n          </div>\n\n          <textarea\n            className={styles.textareaComentario}\n            placeholder=\"Escribe tu comentario...\"\n            value={newComentario}\n            onChange={(e) => setNewComentario(e.target.value)}\n          />\n          <button className={styles.buttonComentario} onClick={handleAddComentario}>Enviar comentario</button>\n        </div>\n      )}\n\n\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}