{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/lib/supabaseClient.ts"],"sourcesContent":["'use client';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useEffect } from 'react';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey, {\r\n  auth: {\r\n    persistSession: true,\r\n    autoRefreshToken: true,\r\n    detectSessionInUrl: true,\r\n  },\r\n});\r\n\r\nexport function useAuth(onAuth: (session: any) => void) {\r\n  useEffect(() => {\r\n    const { data: subscription } = supabase.auth.onAuthStateChange(\r\n      async (event, session) => {\r\n        if (event === 'SIGNED_IN') {\r\n          onAuth(session);\r\n        } else if (event === 'SIGNED_OUT') {\r\n          onAuth(null);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => subscription?.subscription?.unsubscribe();\r\n  }, [onAuth]);\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAIA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,CAAA,GAAA,uLAAA,CAAA,eAAY,AAAD,EAAE,aAAa,iBAAiB;IACjE,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF;AAEO,SAAS,QAAQ,MAA8B;IACpD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB,CAC5D,OAAO,OAAO;YACZ,IAAI,UAAU,aAAa;gBACzB,OAAO;YACT,OAAO,IAAI,UAAU,cAAc;gBACjC,OAAO;YACT;QACF;QAGF,OAAO,IAAM,cAAc,cAAc;IAC3C,GAAG;QAAC;KAAO;AACb","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/app/mapa/page.tsx"],"sourcesContent":["'use client';\nimport { useEffect, useRef, useState } from 'react';\nimport mapboxgl from 'mapbox-gl';\nimport { supabase } from '@/lib/supabaseClient';\nimport 'mapbox-gl/dist/mapbox-gl.css';\n\ninterface Candidato {\n  id: number;\n  nombre: string;\n  entidad: string;\n  cargo: string;\n  partido_id: number;\n  partido?: { nombre: string };\n}\n\ninterface Entidad {\n  id: number;\n  nombre: string;\n  lat: number;\n  lng: number;\n}\n\nmapboxgl.accessToken =\n  'pk.eyJ1IjoicGFyYWxsZWxkdWNrIiwiYSI6ImNseGtwbHphajAzczkyaXB4eG40aHA3eXkifQ.WZedrqvzwybmGa93mi-cdg';\n\nexport default function Mapa() {\n  const mapContainer = useRef<HTMLDivElement>(null);\n  const [map, setMap] = useState<mapboxgl.Map | null>(null);\n  const [selectedEntidad, setSelectedEntidad] = useState<Entidad | null>(null);\n  const [entidades, setEntidades] = useState<Entidad[]>([]);\n  const [candidatosPorEntidad, setCandidatosPorEntidad] = useState<Record<string, Candidato[]>>({});\n  const [candidatosEntidad, setCandidatosEntidad] = useState<Candidato[]>([]);\n  const [search, setSearch] = useState('');\n\n  useEffect(() => {\n    const initializeMap = async () => {\n      if (!mapContainer.current || map) return;\n\n      const mapInstance = new mapboxgl.Map({\n        container: mapContainer.current,\n        style: 'mapbox://styles/mapbox/streets-v12',\n        center: [-99.1332, 19.4326],\n        zoom: 5,\n      });\n      setMap(mapInstance);\n\n      const { data: entidadesData } = await supabase.from('Entidades').select('*');\n      if (!entidadesData) return;\n      setEntidades(entidadesData);\n\n      const { data: candidatosData } = await supabase\n        .from('candidatos')\n        .select('id, nombre, cargo, entidad, partido_id, partidos(nombre)');\n      if (!candidatosData) return;\n\n      const candidatosMap: Record<string, Candidato[]> = {};\n      candidatosData.forEach((c: any) => {\n        const key = c.entidad.trim().toLowerCase();\n        if (!candidatosMap[key]) candidatosMap[key] = [];\n        candidatosMap[key].push({\n          ...c,\n          partido: c.partidos ? { nombre: c.partidos.nombre } : undefined,\n        });\n      });\n      setCandidatosPorEntidad(candidatosMap);\n\n      entidadesData.forEach((entidad) => {\n        const marker = new mapboxgl.Marker({ color: '#0070f3' })\n          .setLngLat([entidad.lng, entidad.lat])\n          .setPopup(new mapboxgl.Popup().setText(entidad.nombre))\n          .addTo(mapInstance);\n\n        marker.getElement().addEventListener('click', () => {\n          setSelectedEntidad(entidad);\n          const candidatosDeEstaEntidad =\n            candidatosMap[entidad.nombre.trim().toLowerCase()] || [];\n          setCandidatosEntidad(candidatosDeEstaEntidad);\n        });\n      });\n    };\n\n    initializeMap();\n    return () => map?.remove();\n  }, [map]);\n\n  const filteredCandidatos = candidatosEntidad.filter((c) =>\n    c.nombre.toLowerCase().includes(search.toLowerCase())\n  );\n\n  return (\n    <div style={{ position: 'relative', width: '100%', height: '100vh', fontFamily: 'Montserrat, Arial, sans-serif', background: 'linear-gradient(135deg, #f5f5f5, #e0e4f1)' }}>\n      {/* Header fijo arriba */}\n      <header\n        style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          width: '100%',\n          background: 'linear-gradient(90deg, #1e3a8a, #4dd0b0)',\n          color: '#fff',\n          padding: '1rem 2rem',\n          display: 'flex',\n          justifyContent: 'space-between',\n          alignItems: 'center',\n          zIndex: 1000,\n          backdropFilter: 'blur(6px)',\n          boxShadow: '0 2px 10px rgba(0,0,0,0.2)',\n          borderBottomLeftRadius: '12px',\n          borderBottomRightRadius: '12px',\n        }}\n      >\n        <h1 style={{ margin: 0, fontSize: '1.6rem', fontWeight: 700, letterSpacing: '0.5px' }}>\n          Mapa de Candidatos\n        </h1>\n        <button\n          onClick={() => (window.location.href = '/dashboard')}\n          style={{\n            padding: '0.6rem 1.4rem',\n            background: '#318422ff',\n            color: '#fff',\n            border: 'none',\n            borderRadius: '8px',\n            cursor: 'pointer',\n            fontSize: '1rem',\n            fontWeight: 500,\n            transition: 'all 0.3s ease',\n          }}\n          onMouseEnter={(e) => ((e.target as HTMLButtonElement).style.background = '#1e3a8a')}\n          onMouseLeave={(e) => ((e.target as HTMLButtonElement).style.background = '#318422ff')}\n        >\n          Regresar\n        </button>\n      </header>\n\n      {/* Mapa */}\n      <div\n        ref={mapContainer}\n        style={{\n          width: '100%',\n          height: '100%',\n          borderRadius: '8px',\n          marginTop: '4rem', // dejar espacio al header\n        }}\n      />\n\n      {/* Panel lateral flotante */}\n      {selectedEntidad && (\n        <div\n          style={{\n            position: 'fixed',\n            top: '4rem',\n            right: 0,\n            bottom: 0,\n            width: '350px',\n            maxWidth: '90%',\n            background: '#f9f9f9',\n            boxShadow: '-3px 0 20px rgba(0,0,0,0.15)',\n            borderLeft: '2px solid #4dd0b0',\n            borderRadius: '12px 0 0 12px',\n            padding: '1rem',\n            overflowY: 'auto',\n            zIndex: 1000,\n            display: 'flex',\n            flexDirection: 'column',\n          }}\n        >\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' }}>\n            <h2 style={{ margin: 0, fontSize: '1.4rem', color: '#1e3a8a' }}>{selectedEntidad.nombre}</h2>\n            <button\n              onClick={() => setSelectedEntidad(null)}\n              style={{\n                background: 'transparent',\n                border: 'none',\n                fontSize: '1.4rem',\n                cursor: 'pointer',\n                color: '#888',\n              }}\n            >\n              ✕\n            </button>\n          </div>\n\n          {/* Barra de búsqueda */}\n          <input\n            type=\"text\"\n            placeholder=\"Buscar candidato...\"\n            value={search}\n            onChange={(e) => setSearch(e.target.value)}\n            style={{\n              margin: '0 0 1rem 0',\n              padding: '0.5rem 0.75rem',\n              borderRadius: '30px',\n              border: '1px solid #ccc',\n              fontSize: '1rem',\n              width: '100%',\n              boxSizing: 'border-box',\n              outline: 'none',\n            }}\n          />\n\n          {filteredCandidatos.length > 0 ? (\n            <ul style={{ listStyle: 'none', padding: 0, flex: 1 }}>\n              {filteredCandidatos.map((candidato) => (\n                <li\n                  key={candidato.id}\n                  style={{\n                    padding: '0.75rem 1rem',\n                    borderBottom: '1px solid #dfe3ee',\n                    transition: 'all 0.2s ease-in-out',\n                    borderRadius: '8px',\n                    marginBottom: '0.5rem',\n                    background: 'white',\n                    boxShadow: '0 1px 4px rgba(0,0,0,0.08)',\n                    display: 'flex',\n                    justifyContent: 'space-between',\n                    alignItems: 'center',\n                    cursor: 'pointer',\n                  }}\n                  onClick={() => window.location.href = `/candidatos/${candidato.id}`}\n                  title=\"Ver detalles del candidato\"\n                >\n                  <div>\n                    <strong style={{ display: 'block', fontSize: '1.1rem', color: '#1e3a8a', marginBottom: '0.2rem' }}>\n                      {candidato.nombre}\n                    </strong>\n                    <span style={{ color: '#555', fontSize: '0.95rem' }}>{candidato.cargo}</span>\n                    <br />\n                    <span style={{ color: '#4dd0b0', fontStyle: 'italic', fontSize: '0.9rem' }}>\n                      {candidato.partido?.nombre || candidato.partido_id}\n                    </span>\n                  </div>\n                  <span style={{ fontSize: '1.2rem', color: '#318422', fontWeight: 600 }}>→</span>\n                </li>\n              ))}\n            </ul>\n          ) : (\n            <p style={{ color: '#666', textAlign: 'center', marginTop: '1rem' }}>No hay candidatos que coincidan.</p>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}