{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/lib/supabaseClient.ts"],"sourcesContent":["'use client';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useEffect } from 'react';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseKey, {\r\n  auth: {\r\n    persistSession: true,\r\n    autoRefreshToken: true,\r\n    detectSessionInUrl: true,\r\n  },\r\n});\r\n\r\nexport function useAuth(onAuth: (session: any) => void) {\r\n  useEffect(() => {\r\n    const { data: subscription } = supabase.auth.onAuthStateChange(\r\n      async (event, session) => {\r\n        if (event === 'SIGNED_IN') {\r\n          onAuth(session);\r\n        } else if (event === 'SIGNED_OUT') {\r\n          onAuth(null);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => subscription?.subscription?.unsubscribe();\r\n  }, [onAuth]);\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAIA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,CAAA,GAAA,uLAAA,CAAA,eAAY,AAAD,EAAE,aAAa,aAAa;IAC7D,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF;AAEO,SAAS,QAAQ,MAA8B;IACpD,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB,CAC5D,OAAO,OAAO;YACZ,IAAI,UAAU,aAAa;gBACzB,OAAO;YACT,OAAO,IAAI,UAAU,cAAc;gBACjC,OAAO;YACT;QACF;QAGF,OAAO,IAAM,cAAc,cAAc;IAC3C,GAAG;QAAC;KAAO;AACb","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/app/mapa/page.tsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport mapboxgl from 'mapbox-gl';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport 'mapbox-gl/dist/mapbox-gl.css';\r\n\r\ninterface Candidato {\r\n  id: number;\r\n  nombre: string;\r\n  entidad: string;\r\n  cargo: string;\r\n  partido_id: number;\r\n  partido?: { nombre: string };\r\n}\r\n\r\ninterface Entidad {\r\n  id: number;\r\n  nombre: string;\r\n  lat: number;\r\n  lng: number;\r\n}\r\n\r\nmapboxgl.accessToken =\r\n  'pk.eyJ1IjoicGFyYWxsZWxkdWNrIiwiYSI6ImNseGtwbHphajAzczkyaXB4eG40aHA3eXkifQ.WZedrqvzwybmGa93mi-cdg';\r\n\r\nexport default function Mapa() {\r\n  const mapContainer = useRef<HTMLDivElement>(null);\r\n  const [map, setMap] = useState<mapboxgl.Map | null>(null);\r\n  const [selectedEntidad, setSelectedEntidad] = useState<Entidad | null>(null);\r\n  const [entidades, setEntidades] = useState<Entidad[]>([]);\r\n  const [candidatosPorEntidad, setCandidatosPorEntidad] = useState<Record<string, Candidato[]>>({});\r\n  const [candidatosEntidad, setCandidatosEntidad] = useState<Candidato[]>([]);\r\n  const [search, setSearch] = useState('');\r\n\r\n  useEffect(() => {\r\n    const initializeMap = async () => {\r\n      if (!mapContainer.current || map) return;\r\n\r\n      const mapInstance = new mapboxgl.Map({\r\n        container: mapContainer.current,\r\n        style: 'mapbox://styles/mapbox/streets-v12',\r\n        center: [-99.1332, 19.4326],\r\n        zoom: 5,\r\n      });\r\n      setMap(mapInstance);\r\n\r\n      const { data: entidadesData } = await supabase.from('Entidades').select('*');\r\n      if (!entidadesData) return;\r\n      setEntidades(entidadesData);\r\n\r\n      const { data: candidatosData } = await supabase\r\n        .from('candidatos')\r\n        .select('id, nombre, cargo, entidad, partido_id, partidos(nombre)');\r\n      if (!candidatosData) return;\r\n\r\n      const candidatosMap: Record<string, Candidato[]> = {};\r\n      candidatosData.forEach((c: any) => {\r\n        const key = c.entidad.trim().toLowerCase();\r\n        if (!candidatosMap[key]) candidatosMap[key] = [];\r\n        candidatosMap[key].push({\r\n          ...c,\r\n          partido: c.partidos ? { nombre: c.partidos.nombre } : undefined,\r\n        });\r\n      });\r\n      setCandidatosPorEntidad(candidatosMap);\r\n\r\n      entidadesData.forEach((entidad) => {\r\n        const marker = new mapboxgl.Marker({ color: 'blue' })\r\n          .setLngLat([entidad.lng, entidad.lat])\r\n          .setPopup(new mapboxgl.Popup().setText(entidad.nombre))\r\n          .addTo(mapInstance);\r\n\r\n        marker.getElement().addEventListener('click', () => {\r\n          setSelectedEntidad(entidad);\r\n          const candidatosDeEstaEntidad =\r\n            candidatosMap[entidad.nombre.trim().toLowerCase()] || [];\r\n          setCandidatosEntidad(candidatosDeEstaEntidad);\r\n        });\r\n      });\r\n    };\r\n\r\n    initializeMap();\r\n    return () => map?.remove();\r\n  }, [map]);\r\n\r\n  const filteredCandidatos = candidatosEntidad.filter((c) =>\r\n    c.nombre.toLowerCase().includes(search.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <div style={{ position: 'relative', width: '100%', height: '100vh', fontFamily: 'Arial, sans-serif' }}>\r\n      {/* Header fijo arriba */}\r\n      <header\r\n        style={{\r\n          position: 'fixed',\r\n          top: 0,\r\n          left: 0,\r\n          width: '100%',\r\n          background: 'rgba(52,58,64,0.9)',\r\n          color: '#fff',\r\n          padding: '1rem 1.5rem',\r\n          display: 'flex',\r\n          justifyContent: 'space-between',\r\n          alignItems: 'center',\r\n          zIndex: 1000,\r\n          backdropFilter: 'blur(6px)',\r\n          boxSizing: 'border-box',\r\n        }}\r\n      >\r\n        <h1 style={{ margin: 0, fontSize: '1.5rem' }}>Mapa de Candidatos</h1>\r\n        <button\r\n          onClick={() => (window.location.href = '/dashboard')}\r\n          style={{\r\n            padding: '0.5rem 1rem',\r\n            background: '#0070f3',\r\n            color: '#fff',\r\n            border: 'none',\r\n            borderRadius: '6px',\r\n            cursor: 'pointer',\r\n          }}\r\n        >\r\n          Regresar\r\n        </button>\r\n      </header>\r\n\r\n      {/* Mapa */}\r\n      <div\r\n        ref={mapContainer}\r\n        style={{\r\n          width: '100%',\r\n          height: '100%',\r\n          borderRadius: '8px',\r\n          marginTop: '4rem', // dejar espacio al header\r\n        }}\r\n      />\r\n\r\n      {/* Panel lateral flotante */}\r\n      {selectedEntidad && (\r\n        <div\r\n          style={{\r\n            position: 'fixed',\r\n            top: '4rem', // debajo del header\r\n            right: 0,\r\n            bottom: 0,\r\n            width: '350px',\r\n            maxWidth: '90%',\r\n            background: '#fff',\r\n            boxShadow: '-3px 0 20px rgba(0,0,0,0.3)',\r\n            borderLeft: '2px solid #0070f3',\r\n            borderRadius: '12px 0 0 12px',\r\n            padding: '1rem',\r\n            overflowY: 'auto',\r\n            zIndex: 1000,\r\n            display: 'flex',\r\n            flexDirection: 'column',\r\n          }}\r\n        >\r\n          <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n            <h2 style={{ margin: 0, fontSize: '1.4rem', color: '#0070f3' }}>{selectedEntidad.nombre}</h2>\r\n            <button\r\n              onClick={() => setSelectedEntidad(null)}\r\n              style={{\r\n                background: 'transparent',\r\n                border: 'none',\r\n                fontSize: '1.4rem',\r\n                cursor: 'pointer',\r\n                color: '#888',\r\n              }}\r\n            >\r\n              ✕\r\n            </button>\r\n          </div>\r\n\r\n          {/* Barra de búsqueda */}\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Buscar candidato...\"\r\n            value={search}\r\n            onChange={(e) => setSearch(e.target.value)}\r\n            style={{\r\n              margin: '1rem 0',\r\n              padding: '0.5rem 0.75rem',\r\n              borderRadius: '8px',\r\n              border: '1px solid #ccc',\r\n              fontSize: '1rem',\r\n              width: '100%',\r\n              boxSizing: 'border-box',\r\n            }}\r\n          />\r\n\r\n          {filteredCandidatos.length > 0 ? (\r\n            <ul style={{ listStyle: 'none', padding: 0, flex: 1 }}>\r\n              {filteredCandidatos.map((candidato) => (\r\n                <li\r\n                  key={candidato.id}\r\n                  style={{\r\n                    padding: '0.5rem 0',\r\n                    borderBottom: '1px solid #eee',\r\n                  }}\r\n                >\r\n                  <strong style={{ display: 'block', fontSize: '1.1rem', color: '#333' }}>\r\n                    {candidato.nombre}\r\n                  </strong>\r\n                  <span style={{ color: '#555' }}>{candidato.cargo}</span>\r\n                  <br />\r\n                  <span style={{ color: '#555', fontStyle: 'italic' }}>\r\n                    {candidato.partido?.nombre || candidato.partido_id}\r\n                  </span>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          ) : (\r\n            <p style={{ color: '#666' }}>No hay candidatos que coincidan.</p>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}