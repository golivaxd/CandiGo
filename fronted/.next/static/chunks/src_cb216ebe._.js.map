{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/lib/supabaseClient.ts"],"sourcesContent":["'use client';\r\nimport { createClient } from '@supabase/supabase-js';\r\nimport { useEffect } from 'react';\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseKey, {\r\n  auth: {\r\n    persistSession: true,\r\n    autoRefreshToken: true,\r\n    detectSessionInUrl: true,\r\n  },\r\n});\r\n\r\nexport function useAuth(onAuth: (session: any) => void) {\r\n  useEffect(() => {\r\n    const { data: subscription } = supabase.auth.onAuthStateChange(\r\n      async (event, session) => {\r\n        if (event === 'SIGNED_IN') {\r\n          onAuth(session);\r\n        } else if (event === 'SIGNED_OUT') {\r\n          onAuth(null);\r\n        }\r\n      }\r\n    );\r\n\r\n    return () => subscription?.subscription?.unsubscribe();\r\n  }, [onAuth]);\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAIoB;AAHpB;AACA;;AAFA;;;AAIA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,CAAA,GAAA,0LAAA,CAAA,eAAY,AAAD,EAAE,aAAa,aAAa;IAC7D,MAAM;QACJ,gBAAgB;QAChB,kBAAkB;QAClB,oBAAoB;IACtB;AACF;AAEO,SAAS,QAAQ,MAA8B;;IACpD,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;6BAAE;YACR,MAAM,EAAE,MAAM,YAAY,EAAE,GAAG,SAAS,IAAI,CAAC,iBAAiB;qCAC5D,OAAO,OAAO;oBACZ,IAAI,UAAU,aAAa;wBACzB,OAAO;oBACT,OAAO,IAAI,UAAU,cAAc;wBACjC,OAAO;oBACT;gBACF;;YAGF;qCAAO;wBAAM;2BAAA,yBAAA,oCAAA,6BAAA,aAAc,YAAY,cAA1B,iDAAA,2BAA4B,WAAW;;;QACtD;4BAAG;QAAC;KAAO;AACb;GAdgB","debugId":null}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/foro/foro.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"backButton\": \"foro-module__h9DDxW__backButton\",\n  \"buttonComentario\": \"foro-module__h9DDxW__buttonComentario\",\n  \"comentario\": \"foro-module__h9DDxW__comentario\",\n  \"comentariosList\": \"foro-module__h9DDxW__comentariosList\",\n  \"container\": \"foro-module__h9DDxW__container\",\n  \"debateAuthor\": \"foro-module__h9DDxW__debateAuthor\",\n  \"debateDescription\": \"foro-module__h9DDxW__debateDescription\",\n  \"debateDetail\": \"foro-module__h9DDxW__debateDetail\",\n  \"debateItem\": \"foro-module__h9DDxW__debateItem\",\n  \"debateList\": \"foro-module__h9DDxW__debateList\",\n  \"debateTitle\": \"foro-module__h9DDxW__debateTitle\",\n  \"footer\": \"foro-module__h9DDxW__footer\",\n  \"header\": \"foro-module__h9DDxW__header\",\n  \"newDebateButton\": \"foro-module__h9DDxW__newDebateButton\",\n  \"textareaComentario\": \"foro-module__h9DDxW__textareaComentario\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 81, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Goliva/Desktop/CandiGo/fronted/src/app/foro/page.tsx"],"sourcesContent":["'use client';\r\nimport { useEffect, useState } from 'react';\r\nimport { supabase } from '@/lib/supabaseClient';\r\nimport styles from './foro.module.css';\r\n\r\ninterface Debate {\r\n  id: number;\r\n  title: string;\r\n  author: string;\r\n  created_at: string;\r\n  description: string;\r\n}\r\n\r\ninterface Comentario {\r\n  id: number;\r\n  debate_id: number;\r\n  autor: string;\r\n  contenido: string;\r\n  created_at: string;\r\n  user_id: string;\r\n}\r\n\r\nexport default function Foro() {\r\n  const [debates, setDebates] = useState<Debate[]>([]);\r\n  const [selectedDebate, setSelectedDebate] = useState<Debate | null>(null);\r\n  const [comentarios, setComentarios] = useState<Comentario[]>([]);\r\n  const [newComentario, setNewComentario] = useState('');\r\n  const [newDebateTitle, setNewDebateTitle] = useState('');\r\n  const [newDebateDescription, setNewDebateDescription] = useState('');\r\n  const [showNewDebateForm, setShowNewDebateForm] = useState(false);\r\n  const [user, setUser] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    fetchDebates();\r\n\r\n    // Obtener usuario autenticado\r\n    supabase.auth.getSession().then(({ data }) => {\r\n      if (data.session) setUser(data.session.user);\r\n    });\r\n\r\n    // Escuchar cambios de auth\r\n    supabase.auth.onAuthStateChange((_event, session) => {\r\n      setUser(session?.user || null);\r\n    });\r\n  }, []);\r\n\r\n  const fetchDebates = async () => {\r\n    const { data } = await supabase\r\n      .from('debates')\r\n      .select('*')\r\n      .order('created_at', { ascending: false });\r\n    if (data) setDebates(data);\r\n  };\r\n\r\n  const fetchComentarios = async (debateId: number) => {\r\n    const { data } = await supabase\r\n      .from('comentarios')\r\n      .select('*')\r\n      .eq('debate_id', debateId)\r\n      .order('created_at', { ascending: true });\r\n    if (data) setComentarios(data);\r\n  };\r\n\r\n  const handleDebateClick = (debate: Debate) => {\r\n    setSelectedDebate(debate);\r\n    fetchComentarios(debate.id);\r\n  };\r\n\r\n  const handleAddComentario = async () => {\r\n    if (!newComentario.trim() || !selectedDebate || !user) return;\r\n\r\n    const displayName = user.user_metadata?.full_name || user.user_metadata?.display_name || 'Usuario';\r\n\r\n    const { data } = await supabase\r\n      .from('comentarios')\r\n      .insert({\r\n        debate_id: selectedDebate.id,\r\n        autor: displayName,\r\n        contenido: newComentario,\r\n        created_at: new Date().toISOString(),\r\n        user_id: user.id\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (data) {\r\n      setComentarios([...comentarios, data]);\r\n      setNewComentario(''); // Limpiar textarea\r\n    }\r\n  };\r\n\r\n  const handleAddDebate = async () => {\r\n    if (!newDebateTitle.trim() || !newDebateDescription.trim() || !user) return;\r\n\r\n    const displayName = user.user_metadata?.full_name || user.user_metadata?.display_name || 'Usuario';\r\n\r\n    const { data } = await supabase\r\n      .from('debates')\r\n      .insert({\r\n        title: newDebateTitle,\r\n        description: newDebateDescription,\r\n        author: displayName,\r\n        created_at: new Date().toISOString()\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (data) {\r\n      setDebates([data, ...debates]); // Mostrar nuevo debate de inmediato\r\n      setShowNewDebateForm(false);\r\n      setNewDebateTitle('');       // Limpiar campo\r\n      setNewDebateDescription(''); // Limpiar campo\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className={styles.container}>\r\n      {/* HEADER */}\r\n      <header className={styles.header}>\r\n        <h1>Foro de Debates</h1>\r\n        <button onClick={() => window.location.href = '/dashboard'}>← Regresar</button>\r\n      </header>\r\n\r\n      {/* LISTA DE DEBATES */}\r\n      {!selectedDebate && !showNewDebateForm && (\r\n        <>\r\n          <button className={styles.newDebateButton} onClick={() => setShowNewDebateForm(true)}>\r\n            + Nuevo Debate\r\n          </button>\r\n          <ul className={styles.debateList}>\r\n            {debates.map((debate) => (\r\n              <li key={debate.id} className={styles.debateItem} onClick={() => handleDebateClick(debate)}>\r\n                <h3 className={styles.debateTitle}>{debate.title}</h3>\r\n                <p className={styles.debateDescription}>{debate.description}</p>\r\n                <small className={styles.debateAuthor}>\r\n                  Por {debate.author} - {new Date(debate.created_at).toLocaleString()}\r\n                </small>\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </>\r\n      )}\r\n\r\n      {/* FORMULARIO NUEVO DEBATE */}\r\n      {showNewDebateForm && (\r\n        <div>\r\n          <button className={styles.backButton} onClick={() => setShowNewDebateForm(false)}>← Volver</button>\r\n          <h2>Crear nuevo debate</h2>\r\n          <input\r\n            placeholder=\"Título del debate\"\r\n            value={newDebateTitle}\r\n            onChange={(e) => setNewDebateTitle(e.target.value)}\r\n            style={{ width: '100%', marginBottom: '0.5rem', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ccc' }}\r\n          />\r\n          <textarea\r\n            placeholder=\"Descripción\"\r\n            value={newDebateDescription}\r\n            onChange={(e) => setNewDebateDescription(e.target.value)}\r\n            style={{ width: '100%', padding: '0.5rem', borderRadius: '6px', border: '1px solid #ccc', minHeight: '80px', marginBottom: '0.5rem' }}\r\n          />\r\n          <button className={styles.newDebateButton} onClick={handleAddDebate}>Crear Debate</button>\r\n        </div>\r\n      )}\r\n\r\n      {/* DETALLE DE DEBATE */}\r\n      {selectedDebate && (\r\n        <div>\r\n          <button className={styles.backButton} onClick={() => setSelectedDebate(null)}>← Volver a debates</button>\r\n          <h2 className={styles.debateTitle}>{selectedDebate.title}</h2>\r\n          <p className={styles.debateDescription}>{selectedDebate.description}</p>\r\n          <small className={styles.debateAuthor}>\r\n            Por {selectedDebate.author} - {new Date(selectedDebate.created_at).toLocaleString()}\r\n          </small>\r\n\r\n          <h3>Comentarios</h3>\r\n          <div className={styles.comentariosList}>\r\n            {comentarios.map((c) => (\r\n              <div key={c.id} className={styles.comentario}>\r\n                <strong>{c.autor}</strong> <small>{new Date(c.created_at).toLocaleString()}</small>\r\n                <p>{c.contenido}</p>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          <textarea\r\n            className={styles.textareaComentario}\r\n            placeholder=\"Escribe tu comentario...\"\r\n            value={newComentario}\r\n            onChange={(e) => setNewComentario(e.target.value)}\r\n          />\r\n          <button className={styles.buttonComentario} onClick={handleAddComentario}>Enviar comentario</button>\r\n        </div>\r\n      )}\r\n\r\n      <footer className={styles.footer}>\r\n        Foro de Debates &copy; 2025\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}